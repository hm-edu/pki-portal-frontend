{"components":{"schemas":{"echo.HTTPError":{"properties":{"message":{}},"type":"object"},"model.Delegation":{"properties":{"id":{"type":"integer"},"user":{"type":"string"}},"type":"object"},"model.DelegationRequest":{"properties":{"user":{"type":"string"}},"required":["user"],"type":"object"},"model.Domain":{"properties":{"approved":{"type":"boolean"},"delegations":{"items":{"$ref":"#/components/schemas/model.Delegation"},"type":"array"},"fqdn":{"type":"string"},"id":{"type":"integer"},"owner":{"type":"string"},"permissions":{"$ref":"#/components/schemas/model.Permissions"}},"type":"object"},"model.DomainRequest":{"properties":{"fqdn":{"type":"string"}},"required":["fqdn"],"type":"object"},"model.Permissions":{"properties":{"can_approve":{"type":"boolean"},"can_delegate":{"type":"boolean"},"can_delete":{"type":"boolean"},"can_transfer":{"type":"boolean"}},"type":"object"},"model.TransferRequest":{"properties":{"owner":{"type":"string"}},"required":["owner"],"type":"object"}},"securitySchemes":{"API":{"bearerFormat":"JWT","scheme":"bearer","type":"http"}}},"info":{"contact":{"name":"Source Code","url":"https://github.com/hm-edu/portal-backend"},"description":"Go microservice for Domain management.","license":{"name":"Apache License","url":"https://github.com/hm-edu/portal-backend/blob/main/LICENSE"},"title":"Domain Service","version":"2.0"},"openapi":"3.0.3","paths":{"/domains/":{"get":{"description":"Lists all domains that are either owned or delegated, or a child of a owned or delegated domain.","responses":{"200":{"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/model.Domain"},"type":"array"}}},"description":"OK"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/echo.HTTPError"}}},"description":"Error processing the request"}},"security":[{"API":[]}],"summary":"List domains.","tags":["Domains"]},"post":{"description":"Creates a new domain if the FQDN is not already taken. Approvement is automatically done, in case the user owns a upper zone or a upper zone was already delegated to him.","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/model.DomainRequest"}}},"description":"The Domain to create","required":true,"x-originalParamName":"domain"},"responses":{"201":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/model.Domain"}}},"description":"Created"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/echo.HTTPError"}}},"description":"Error processing the request"}},"security":[{"API":[]}],"summary":"Create a domain.","tags":["Domains"]}},"/domains/{id}":{"delete":{"description":"Deletes a domain. Existing certificates are not are not longer accessible.","parameters":[{"description":"Domain ID","in":"path","name":"id","required":true,"schema":{"type":"integer"}}],"responses":{"204":{"description":""},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/echo.HTTPError"}}},"description":"Error processing the request"}},"security":[{"API":[]}],"summary":"Delete a domain","tags":["Domains"]}},"/domains/{id}/approve":{"post":{"description":"Approves an outstanding domain request","parameters":[{"description":"Domain ID","in":"path","name":"id","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/model.Domain"}}},"description":"OK"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/echo.HTTPError"}}},"description":"Error processing the request"}},"security":[{"API":[]}],"summary":"Approve domain request","tags":["Domains"]}},"/domains/{id}/delegation":{"post":{"description":"Adds a new delegation to an existing domain.","parameters":[{"description":"Domain ID","in":"path","name":"id","required":true,"schema":{"type":"integer"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/model.DelegationRequest"}}},"description":"The Delegation to add","required":true,"x-originalParamName":"delegation"},"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/model.Domain"}}},"description":"OK"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/echo.HTTPError"}}},"description":"Error processing the request"}},"security":[{"API":[]}],"summary":"Add delegation.","tags":["Domains"]}},"/domains/{id}/delegation/{delegation}":{"delete":{"description":"Deletes an existing delegation.","parameters":[{"description":"Domain ID","in":"path","name":"id","required":true,"schema":{"type":"integer"}},{"description":"Delegation ID","in":"path","name":"delegation","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/model.Domain"}}},"description":"OK"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/echo.HTTPError"}}},"description":"Error processing the request"}},"security":[{"API":[]}],"summary":"Delete delegation.","tags":["Domains"]}},"/domains/{id}/transfer":{"post":{"description":"Transfers a domain to a new owner. Transferring is only possible if you are either the owner of the domain itself or responsible for one of the parent zones.","parameters":[{"description":"Domain ID","in":"path","name":"id","required":true,"schema":{"type":"integer"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/model.TransferRequest"}}},"description":"The Domain to transfer","required":true,"x-originalParamName":"domain"},"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/model.Domain"}}},"description":"OK"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/echo.HTTPError"}}},"description":"Error processing the request"}},"security":[{"API":[]}],"summary":"Transfer domain","tags":["Domains"]}},"/whoami":{"get":{"description":"Returns the username of the logged in user","responses":{"200":{"content":{"application/json":{"schema":{"type":"string"}}},"description":"Username"},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/echo.HTTPError"}}},"description":"Unauthorized"}},"security":[{"API":[]}],"summary":"whoami Endpoint","tags":["User"]}}}}
